split out functions into lib.rs
